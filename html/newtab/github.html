<style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');

    body {
        font-size: 16px;
        font-family: 'Noto Sans SC', sans-serif;
        color: white;
    }

    .item {
        background: rgba(0, 0, 0, 0.7);
        border: 2px solid #0066cc;
        border-radius: 30px;
        padding: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(5px);
        color: white;
        opacity: 0;
        transform: translateY(30px);
        animation: cardSlideUp 0.6s ease forwards;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        box-sizing: border-box;
        margin-bottom: 15px;
    }

    .item:hover {
        border-color: rgba(0, 102, 204, 0.9);
        box-shadow: 0 8px 35px rgba(0, 102, 204, 0.25);
        transform: translateY(-5px) scale(1.02);
    }

    .title {
        font-size: 18px;
        font-weight: bold;
    }

    .title a {
        color: white;
        text-decoration: none;
    }

    .title a:hover {
        color: #0066cc;
    }

    .pr-meta {
        margin-top: 8px;
        font-size: 14px;
        opacity: 0.8;
    }

    .pr-state {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 12px;
        background: rgba(0, 123, 255, 0.2);
        margin-left: 10px;
    }

    .issue-label {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 12px;
        margin-right: 5px;
        margin-top: 5px;
        font-weight: 500;
    }

    .labels-container {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-top: 10px;
    }

    @keyframes cardSlideUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .item:nth-child(1) {
        animation-delay: 0.1s;
    }

    .item:nth-child(2) {
        animation-delay: 0.2s;
    }

    .item:nth-child(3) {
        animation-delay: 0.3s;
    }

    .item:nth-child(4) {
        animation-delay: 0.4s;
    }

    .item:nth-child(5) {
        animation-delay: 0.5s;
    }

    #pr-list,
    #issue-list {
        max-height: 400px;
        overflow-y: auto;
        padding: 20px;
        box-sizing: border-box;
    }

    #pr-list::-webkit-scrollbar,
    #issue-list::-webkit-scrollbar {
        width: 6px;
    }

    #pr-list::-webkit-scrollbar-track,
    #issue-list::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
    }

    #pr-list::-webkit-scrollbar-thumb,
    #issue-list::-webkit-scrollbar-thumb {
        background: rgba(0, 102, 204, 0.6);
        border-radius: 3px;
    }

    details {
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
        border: 1px solid #333;
    }

    summary {
        font-size: 1.2rem;
        font-weight: bold;
        cursor: pointer;
        padding: 10px;
        margin: -15px -15px 0 -15px;
        border-radius: 10px 10px 0 0;
        background: rgba(0, 102, 204, 0.2);
    }

    summary:hover {
        background: rgba(0, 102, 204, 0.3);
    }

    h3,
    h4 {
        color: white;
        display: flex;
        align-items: center;
    }

    h3 {
        margin-top: 0;
    }

    .loading,
    .error,
    .no-items {
        text-align: center;
        padding: 20px;
        border-radius: 10px;
        margin: 10px 0;
    }

    .loading {
        background: rgba(0, 102, 204, 0.2);
    }

    .error {
        background: rgba(255, 0, 0, 0.2);
        color: #ff6b6b;
    }

    .no-items {
        background: rgba(255, 255, 255, 0.1);
        color: #a0a0a0;
    }

    @media (max-width: 768px) {
        .item {
            width: 100%;
            padding: 15px;
        }
    }
</style>


<h3>
    <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 5px;">
        <path fill="currentColor"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
    </svg>
    GitHub
</h3>

<details open>
    <summary>BlueArchiveArisHelper/BAAH</summary>
    <h4>打开的PR</h4>
    <div id="pr-list"></div>
    <h4>打开的Issues</h4>
    <div id="issue-list"></div>
</details>

<script>
    const owner = "BlueArchiveArisHelper";
    const repo = "BAAH";

    // 获取PR列表
    async function fetchPRs() {
        const prList = document.getElementById('pr-list');

        try {
            const response = await fetch(`https://blockhaity.dpdns.org/ghapi/repos/${owner}/${repo}/pulls?state=open&sort=created&direction=desc`);

            if (!response.ok) {
                throw new Error(`HTTP错误! 状态: ${response.status}`);
            }

            const prs = await response.json();

            if (prs.length === 0) {
                prList.innerHTML = '<div class="no-items">没有找到开启的Pull Requests</div>';
                return;
            }

            let prsHTML = '';

            prs.forEach((pr, index) => {
                const isDraft = pr.draft;

                prsHTML += `
                    <div class="item" style="animation-delay: ${0.1 + index * 0.1}s">
                        <div class="title">
                            <svg fill="#FFFFFF" class="octicon octicon-git-pull-request" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                                <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
                            </svg>
                            <a href="${pr.html_url}" target="_blank">#${pr.number} ${pr.title}</a>
                        </div>
                        <div class="pr-meta">
                            <span class="pr-user">作者: ${pr.user.login}</span>
                            <span class="pr-state">${isDraft ? '草稿' : '开启'}</span>
                        </div>
                        <div class="pr-meta">
                            创建于: ${new Date(pr.created_at).toLocaleString('zh-CN')}
                        </div>
                    </div>
                    `;
            });

            prList.innerHTML = prsHTML;

        } catch (error) {
            console.error('获取PR列表时出错:', error);
            prList.innerHTML = `<div class="error">获取PR列表失败: ${error.message}</div>`;
        }
    }

    // 获取Issues列表
    async function fetchIssues() {
        const issueList = document.getElementById('issue-list');

        try {
            const response = await fetch(`https://blockhaity.dpdns.org/ghapi/repos/${owner}/${repo}/issues?state=open&sort=created&direction=desc`);

            if (!response.ok) {
                throw new Error(`HTTP错误! 状态: ${response.status}`);
            }

            const issues = await response.json();
            // 过滤掉pull requests，只保留纯粹的issues
            const pureIssues = issues.filter(issue => !issue.pull_request);

            if (pureIssues.length === 0) {
                issueList.innerHTML = '<div class="no-items">没有找到开启的Issues</div>';
                return;
            }

            let issuesHTML = '';

            pureIssues.forEach((issue, index) => {
                // 处理标签显示
                let labelsHTML = '';
                if (issue.labels && issue.labels.length > 0) {
                    labelsHTML = issue.labels.map(label =>
                        `<span class="issue-label" style="background-color: #${label.color}; color: ${getContrastColor(label.color)};">${label.name}</span>`
                    ).join('');
                }

                issuesHTML += `
                    <div class="item" style="animation-delay: ${0.1 + index * 0.1}s">
                        <div class="title">
                            <svg fill="#FFFFFF" class="octicon octicon-issue-opened" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                                <path d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"></path>
                                <path fill-rule="evenodd" d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"></path>
                            </svg>
                            <a href="${issue.html_url}" target="_blank">#${issue.number} ${issue.title}</a>
                        </div>
                        <div class="pr-meta">
                            <span class="pr-user">作者: ${issue.user.login}</span>
                            <span class="pr-state">开启</span>
                        </div>
                        <div class="pr-meta">
                            创建于: ${new Date(issue.created_at).toLocaleString('zh-CN')}
                            <span style="margin-left: 10px;">评论数: ${issue.comments}</span>
                        </div>
                        ${labelsHTML ? `<div class="labels-container">${labelsHTML}</div>` : ''}
                    </div>
                    `;
            });

            issueList.innerHTML = issuesHTML;

        } catch (error) {
            console.error('获取Issue列表时出错:', error);
            issueList.innerHTML = `<div class="error">获取Issue列表失败: ${error.message}</div>`;
        }
    }

    // 辅助函数：根据背景色计算合适的文字颜色
    function getContrastColor(hexcolor) {
        const r = parseInt(hexcolor.substr(0, 2), 16);
        const g = parseInt(hexcolor.substr(2, 2), 16);
        const b = parseInt(hexcolor.substr(4, 2), 16);
        const brightness = ((r * 299) + (g * 587) + (b * 114)) / 1000;
        return (brightness > 125) ? '#000000' : '#FFFFFF';
    }

    // 页面加载时获取数据
    window.onload = function () {
        fetchPRs();
        fetchIssues();
    };
</script>